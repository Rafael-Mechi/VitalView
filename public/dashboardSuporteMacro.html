<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard Suporte</title>
    <link rel="stylesheet" href="css/dashSuporteMacro.css">
    <script src="js/sessao.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
</head>

<body>

    <nav class="menu">
        <input type="checkbox" name="chk_hamburguer" id="chk_hamburguer" class="check_hamburguer">

        <section class="hamburguer">
            <span>
                <div class="icones_topo">
                    <img class="img_hamb" src="assets/LogoVitalView.png" alt="">
                    <img src="./assets/dashboard-icons/layout.svg" alt="">
                    <img src="./assets/dashboard-icons/activity.svg" alt="">
                    <img src="./assets/dashboard-icons/calendar.svg" alt="">
                    <img src="./assets/dashboard-icons/bar-chart.svg" alt="">
                </div>

                <div class="icones_baixo">
                    <img src="./assets/dashboard-icons/settings.svg" alt="">
                    <img src="./assets/dashboard-icons/users.svg" alt="">
                    <img src="./assets/dashboard-icons/help-circle.svg" alt="">
                    <img src="./assets/dashboard-icons/log-out.svg" alt="">
                </div>
            </span>
        </section>

        <ul>
            <div class="title_hamb">
                <img class="img_hamb" src="assets/LogoVitalView.png" alt="">
                <h2 class="hamb_nome">VitalView</h2>
            </div>
            <div class="menu_topo">
                <h3 class="title_menu">Dashboards</h3>
                <li>
                    <a href="dashboardAnalista.html"> Dash Analista </a>
                </li>
                <li>
                    <a href="dashboardSuporteMacro.html"> Dash Suporte Macro</a>
                </li>
                <li>
                    <a href="dashboardSuporteMicro.html"> Dash Suporte Micro</a>
                </li>

            </div>

            <div class="menu_baixo">
                <h3 class="title_menu">Outras Opções</h3>
                <li>
                    <a href="historicoAlertas.html">Histórico de Alertas</a>
                </li>
                <li>
                    <a href="cadastroFuncionarios.html"> Cadastro Funcionário </a>
                </li>
                <li>
                    <a href="cadastroServidores.html"> Cadastro Servidores </a>
                </li>
                <li>
                    <a href="https://vitalviewsptech.atlassian.net/servicedesk/customer/portal/1"
                        target="_blank">Central de Serviço </a>
                </li>
                <li>
                    <a onclick="limparSessao()"> Sair </a>
                </li>
            </div>
        </ul>
    </nav>


    <section class="container">
        <section class="nav-dash">
            <section class="secao_logo">
                <a href="dashboardAnalista.html">
                    <img src="assets/LogoVitalView.png" alt="Logo VitalView" class="logo">
                </a>
            </section>

            <section class="secao_logo">
                <h1 class="titulo_header">VitalView</h1>
            </section>
        </section>

        <div class="wrap">

            <!-- KPIs -->
            <section class="kpis">
                <article class="kpi">
                    <h4 class="normal">Servidores em Risco</h4>
                    <div class="value mono">3<span>/6</span></div>
                </article>

                <article class="kpi">
                    <h4 class="normal">Servidor com mais Alertas</h4>
                    <a href="dashboardSuporteMicro.html" class="value-serv">SERVIDOR 1</a>
                </article>

                <article class="kpi">
                    <h4 class="diferente">Alertas</h4>
                    <p>(Últimas 24 horas)</p>
                    <div style="color: #e62323;" class="value mono">16</div>
                </article>

                <article class="kpi">
                    <h4 class="diferente">Tendência de Alertas</h4>
                    <p>(Próximos 30 minutos)</p>
                    <div class="value mono">23%</div>
                </article>
            </section>

            <section class="grid">
                <!-- COLUNA ESQUERDA -->
                <div class="left-col">

                    <!-- Servidores (mini barras) -->
                    <article class="card">


                        <div class="side-left">

                            <div class="stat-card-pizza">
                                <div class="fundo">
                                    <div class="chart-box">
                                        <canvas id="pizzaAlertas"
                                            style="width: 100%; height: 100%; padding-bottom: 20px; padding-right: 10px;"></canvas>
                                    </div>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-label">Servidores<br>Cadastrados</div>
                                <div class="stat-value">6</div>
                            </div>

                        </div>

                        <div class="side-right">
                            <div class="mini">
                                <div class="servers">
                                    <h3 style="color: black;">Lista de Servidores</h3>
                                    <a href="dashboardSuporteMicro.html" class="name">Servidor 1</a>
                                    <div class="server">
                                        <canvas id="mini1" height="48"></canvas>
                                        <div class="status">Crítico</div>
                                    </div>
                                    <a href="dashboardSuporteMicro.html" class="name">Servidor 2</a>
                                    <div class="server">
                                        <canvas id="mini2" height="48"></canvas>
                                        <div class="status">Crítico</div>
                                    </div>
                                    <a href="dashboardSuporteMicro.html" class="name">Servidor 3</a>
                                    <div class="server">
                                        <canvas id="mini3" height="48"></canvas>
                                        <div class="status" style="color:#f59e0b">Atenção</div>
                                    </div>
                                    <a href="dashboardSuporteMicro.html" class="name">Servidor 4</a>
                                    <div class="server">
                                        <canvas id="mini4" height="48"></canvas>
                                        <div class="status" style="color:#6ce5e8">Normal</div>
                                    </div>
                                    <a href="dashboardSuporteMicro.html" class="name">Servidor 5</a>
                                    <div class="server">
                                        <canvas id="mini5" height="48"></canvas>
                                        <div class="status" style="color:#6ce5e8">Normal</div>
                                    </div>
                                    <a href="dashboardSuporteMicro.html" class="name">Servidor 6</a>
                                    <div class="server">
                                        <canvas id="mini6" height="48"></canvas>
                                        <div class="status" style="color:#6ce5e8">Normal</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </article>
                </div>

                <!-- COLUNA DIREITA: Servidores em risco -->
                <aside class="risk-list">
                    <div class="cardD">
                        <!-- Risco 1 -->
                        <div class="scroll">
                            <h3 style="color: black;">Servidores em Risco</h3>
                            <article class="risk">
                                <a href="dashboardSuporteMicro.html" class="nameAlert">Servidor 1</a>
                                <div class="chips">
                                    <span class="pill" style="background:#fee2e2;color:#b91c1c">6 alertas</span>
                                    <span class="pill">Disco</span>
                                </div>
                                <div class="divider"></div>
                                <div class="kv">
                                    <div>CPU: <b>99%</b></div>
                                    <div>Limite: <b>99%</b></div>
                                    <div>RAM: <b>58%</b></div>
                                    <div>Limite: <b>58%</b></div>
                                    <div>Disco: <b>68%</b></div>
                                    <div>Limite: <b>68%</b></div>
                                </div>
                                <div class="sub">Tempo em alerta: 00:16:15</div>
                            </article>

                            <!-- Risco 2 -->
                            <article class="risk">
                                <a href="dashboardSuporteMicro.html" class="nameAlert">Servidor 2</a>
                                <div class="chips">
                                    <span class="pill" style="background:#fee2e2;color:#b91c1c">4 alertas</span>
                                    <span class="pill">RAM</span>
                                </div>
                                <div class="divider"></div>
                                <div class="kv">
                                    <div>CPU: <b>99%</b></div>
                                    <div>Limite: <b>99%</b></div>
                                    <div>RAM: <b>58%</b></div>
                                    <div>Limite: <b>58%</b></div>
                                    <div>Disco: <b>68%</b></div>
                                    <div>Limite: <b>68%</b></div>
                                </div>
                                <div class="sub">Tempo em alerta: 00:09:01</div>
                            </article>

                            <!-- Risco 3 -->
                            <article class="risk">
                                <a href="dashboardSuporteMicro.html" class="nameAlert">Servidor 3</a>
                                <div class="chips">
                                    <span class="pill" style="background:#fee2e2;color:#b91c1c">1 alerta</span>
                                    <span class="pill">Disco</span>
                                </div>
                                <div class="divider"></div>
                                <div class="kv">
                                    <div>CPU: <b>99%</b></div>
                                    <div>Limite: <b>99%</b></div>
                                    <div>RAM: <b>58%</b></div>
                                    <div>Limite: <b>58%</b></div>
                                    <div>Disco: <b>68%</b></div>
                                    <div>Limite: <b>68%</b></div>
                                </div>
                                <div class="sub">Tempo em alerta: 00:16:15</div>
                            </article>
                        </div>
                    </div>
                </aside>
            </section>
        </div>
    </section>

    <script>
        // =========================
        // DADOS MOCADOS / ESTÁTICOS
        // =========================
        const SERVIDORES_MINI = [
            // cpu, ram, disco
            { id: 'mini1', valores: [70, 40, 70] },   // Servidor 1
            { id: 'mini2', valores: [12, 34, 92] },   // Servidor 2
            { id: 'mini3', valores: [55, 61, 48] },   // Servidor 3
            { id: 'mini4', valores: [30, 35, 21] },   // Servidor 4
            { id: 'mini5', valores: [23, 20, 23] },   // Servidor 5
            { id: 'mini6', valores: [19, 21, 12] },  //  Servidor 6
        ];

        // Paleta consistente com a UI
        const COLORS = {
            cpu: '#2d8bba',
            ram: '#6ce5e8',
            disco: '#0d3e47'
        };

        // =========================
        // PIZZA: Alertas x Normais
        // =========================
        const ctx = document.getElementById('pizzaAlertas').getContext('2d');
        new Chart(ctx, {
            type: 'pie',
            data: {
                labels: ['Alerta 34%', 'Normal 66%',],
                datasets: [{
                    data: [34, 66],
                    backgroundColor: ['#2d8bba', '#6ce5e8'],
                    borderWidth: 1
                }]
            },
            options: {
                responsive: false,
                plugins: {
                    legend: {
                        position: 'right'
                    },
                    title: {
                        display: true,
                        text: 'Servidores em Alerta × Normais',
                        font: {
                            size: 21,
                            weight: 'bold',
                        },
                        color: 'black'

                    }
                }
            }
        });

        // ==========================================
        // MINI BARRAS HORIZONTAIS por servidor (CPU/RAM/Disco)
        // ==========================================
        SERVIDORES_MINI.forEach((srv) => {
            const ctx = document.getElementById(srv.id);
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: [''], // uma linha
                    datasets: [
                        { label: 'CPU', data: [srv.valores[0]], backgroundColor: COLORS.cpu, borderRadius: 8, barPercentage: 0.6 },
                        { label: 'RAM', data: [srv.valores[1]], backgroundColor: COLORS.ram, borderRadius: 8, barPercentage: 0.6 },
                        { label: 'Disco', data: [srv.valores[2]], backgroundColor: COLORS.disco, borderRadius: 8, barPercentage: 0.6 },
                    ]
                },
                options: {
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: { boxWidth: 10, usePointStyle: true, pointStyle: 'rectRounded' }
                        },
                        tooltip: {
                            callbacks: {
                                label: (ctx) => `${ctx.dataset.label}: ${ctx.raw}%`
                            }
                        }
                    },
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            min: 0, max: 100, grid: { display: false }, ticks: { callback: v => v + '%' }
                        },
                        y: { grid: { display: false } }
                    }
                }
            });
        });
    </script>
</body>

</html>