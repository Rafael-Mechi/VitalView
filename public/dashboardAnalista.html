<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard</title>
    <link rel="stylesheet" href="css/dashAnalista.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script src="js/sessao.js"></script>
</head>

<body>

    <nav class="menu">
        <input type="checkbox" name="chk_hamburguer" id="chk_hamburguer" class="check_hamburguer">

        <section class="hamburguer">
            <span class="menu_lateral">
                <div class="icones_topo">
                    <img class="img_hamb" src="assets/LogoVitalView.png">
                    <img src="./assets/dashboard-icons/activity.svg" data-role="Analista,Administrador">
                    <img src="./assets/dashboard-icons/bar-chart.svg" data-role="Técnico,Administrador">
                    <img src="./assets/dashboard-icons/layout.svg" data-role="Técnico,Administrador">
                </div>

                <div class="icones_baixo">
                    <img src="./assets/dashboard-icons/gerenciar-usuarios.png" data-role="Administrador" style="width: 28px; height: 28px;">
                    <img src="./assets/dashboard-icons/calendar.svg" data-role="Analista,Técnico,Administrador">
                    <img src="./assets/dashboard-icons/users.svg" data-role="Administrador">
                    <img src="./assets/dashboard-icons/hard-drive.svg" data-role="Técnico,Administrador">
                    <img src="./assets/dashboard-icons/help-circle.svg" data-role="Analista,Técnico,Administrador">
                    <img src="./assets/dashboard-icons/log-out.svg" data-role="Analista,Técnico,Administrador">
                </div>
            </span>
        </section>

        <ul>
            <div class="title_hamb">
                <img class="img_hamb" src="assets/LogoVitalView.png" alt="">
                <h2 class="hamb_nome">VitalView</h2>
            </div>
            <div class="menu_topo">
                <h3 class="title_menu">Dashboards</h3>
                <li style="display: flex; align-items: center;" data-role="Analista,Administrador,Técnico">
                    <img src="./assets/dashboard-icons/home.svg" style="width: 20px; margin-right: 4px;"><a
                        href="bemVindo.html">Home</a>
                </li>
                <li style="display: flex; align-items: center;" data-role="Analista,Administrador" class="pagina-ativa">
                    <img src="./assets/dashboard-icons/activity.svg" style="width: 20px; margin-right: 4px;"><a
                        href="dashboardAnalista.html">Dash Analista</a>
                </li>
                <li style="display: flex; align-items: center;" data-role="Técnico,Administrador"><img
                        src="./assets/dashboard-icons/bar-chart.svg" style="width: 20px; margin-right: 4px;"><a
                        href="dashboardSuporteMacro.html">Dash Suporte Macro</a></li>
                <li style="display: flex; align-items: center;" data-role="Técnico,Administrador"><img
                        src="./assets/dashboard-icons/layout.svg" style="width: 20px; margin-right: 4px;"><a
                        href="dashboardSuporteMicro.html">Dash Suporte Micro</a></li>
            </div>

            <div class="menu_baixo">
                <h3 class="title_menu">Outras Opções</h3>
                <li style="display: flex; align-items: center;" data-role="Administrador"><img
                        src="./assets/dashboard-icons/gerenciar-usuarios.png" style="width: 20px; margin-right: 4px;"><a
                        href="dashControleSistema.html">Gerenciar usuários</a></li>
                <li style="display: flex; align-items: center;" data-role="Analista,Técnico,Administrador"><img
                        src="./assets/dashboard-icons/calendar.svg" style="width: 20px; margin-right: 4px;"><a
                        href="historicoAlertas.html">Histórico de Alertas</a></li>
                <li style="display: flex; align-items: center;" data-role="Administrador"><img
                        src="./assets/dashboard-icons/users.svg" style="width: 20px; margin-right: 4px;"><a
                        href="cadastroFuncionarios.html">Cadastro Funcionário</a></li>
                <li style="display: flex; align-items: center;" data-role="Técnico,Administrador"><img
                        src="./assets/dashboard-icons/hard-drive.svg" style="width: 20px; margin-right: 4px;"><a
                        href="cadastroServidores.html">Cadastro Servidores</a></li>
                <li style="display: flex; align-items: center;" data-role="Analista,Técnico,Administrador"><img
                        src="./assets/dashboard-icons/help-circle.svg" style="width: 20px; margin-right: 4px;"><a
                        href="https://vitalviewsptech.atlassian.net/servicedesk/customer/portal/1"
                        target="_blank">Central de Serviço</a></li>
                <li style="display: flex; align-items: center;" data-role="Analista,Técnico,Administrador"><img
                        src="./assets/dashboard-icons/log-out.svg" style="width: 20px; margin-right: 4px;"><a
                        onclick="limparSessao()">Sair</a></li>
            </div>
        </ul>
    </nav>


    <section class="container">
        <section class="nav-dash">
            <section class="secao_logo">
                <a href="dashboardAnalista.html">
                    <img src="assets/LogoVitalView.png" alt="Logo VitalView" class="logo">
                </a>
            </section>

            <section class="secao_logo">
                <h1 class="titulo_header">VitalView</h1>
            </section>

            <section class="secao_logo">
                <select class="periodo_select" name="periodo" id="periodo_select">
                    <option value="1">Escolher periodo</option>
                    <option value="2">Hoje</option>
                    <option value="3">Nesta semana</option>
                    <option value="4">Neste mês</option>
                    <option value="5">Neste ano</option>
                </select>
            </section>
        </section>

        <section class="container-de-sessoes">
            <section class="sessao-lateral-esquerda">
                <section class="sessao-lateral-esquerda-itens">
                    <div class="server-info" role="group" aria-labelledby="t1">
                        <h3 id="t1" class="titulo-cartao" style="text-align: center;">Top 5 Servidores com mais alertas <small>No [Período]</small>
                        </h3>
                        <div class="wrap-canvas">
                            <canvas id="topServidoresChart" aria-label="Top servidores" role="img"></canvas>
                        </div>
                    </div>

                    <div class="server-info" role="group" aria-labelledby="t2" style=" margin-top: 3%;">
                        <h3 id="t1" class="titulo-cartao" style="text-align: center;">Distribuição de alertas por componente<small>No [Período]</small>
                        </h3>
                        <div class="wrap-canvas">
                            <canvas id="componentesChart" aria-label="Alertas por componente" role="img"></canvas>
                        </div>
                    </div>
                </section>

            </section>
            <section class="sessao-lateral-direita">
                <section class="sessao-lateral-direita-itens" style="height: 30%;">
                    <section class="velocimetro card">
                        <h4 id="c1" style="text-align: center;">Disponibilidade <br><small>Durante o [Período]</small>
                        </h4>
                        <div class="valor grande azul">99.85% <span class="azul">▲</span></div>
                        <p class="legenda">Tempo que os servidores ficaram disponíveis</p>
                    </section>
                    <section class="velocimetro card">
                        <h4 id="c2" style="text-align: center;">Quantidade total de alertas <br><small>Durante o [Período]</small></h4>
                        <div class="valor grande vermelho" style="font-size: 40px; margin-bottom: 20px;">12</div>
                    </section>
                    <section class="velocimetro card" id="uptime">
                        <div class="uptime">
                            <h4 id="c3">MTTR <small>Durante o [Período]</small></h4>
                            <div class="valor grande vermelho">2.5h</div>
                            <p class="legenda">Tempo médio de resolução de Incidentes</p>
                        </div>
                        </div>
                    </section>
                </section>
                <section class="sessao-lateral-direita-itens" id="id_sessao_direita_2">
                    <section id="projecao">
                        <div aria-labelledby="lin">
                            <h4 id="lin" style="font-size: 20px; text-align: center;">Distribuição de alertas ao longo do ano</h4>
                            <canvas id="linhaAnoChart" aria-label="Distribuição no ano" role="img"
                                style="height: 200%; width: 200%;"></canvas>
                        </div>
                    </section>
                </section>
                <section id="sessao-disco" class="sessao-lateral-direita-itens" style="height: 30%; padding-top: 10px; padding-bottom: 10px;">
                    <div class="mini">
                        <h4 style="font-size: 20px;">Projeção de Sobrecarga dos Discos</h4>

                        <div class="servers">
                            <a href="dashboardSuporteMicro.html" class="name">Servidor 1</a>
                            <div class="server">
                            <div class="wrap-mini" style="margin-top: 15px;"><canvas id="mini1"></canvas></div>
                            </div>
                            <a href="dashboardSuporteMicro.html">90%</a>
                            <a href="dashboardSuporteMicro.html">22/12/2025</a>

                            <a href="dashboardSuporteMicro.html" class="name">Servidor 2</a>
                            <div class="server">
                                <div class="wrap-mini"><canvas id="mini2"></canvas></div>
                            </div>
                            <a href="dashboardSuporteMicro.html">40%</a>
                            <a href="dashboardSuporteMicro.html">22/04/2026</a>

                            <a href="dashboardSuporteMicro.html" class="name">Servidor 3</a>
                            <div class="server">
                                <div class="wrap-mini"><canvas id="mini3"></canvas></div>
                            </div>
                            <a href="dashboardSuporteMicro.html">20%</a>
                            <a href="dashboardSuporteMicro.html">30/11/2026</a>

                        </div>
                    </div>
                </section>
            </section>
        </section>
    </section>

    <script src="js/permissoes.js"></script>

    <script>
        protegerPagina(['Analista', 'Administrador']);
        aplicarCargoNaUI();

        Chart.defaults.font.family = "'Poppins', system-ui, -apple-system, 'Segoe UI', Roboto, Arial, sans-serif";
        Chart.defaults.color = "#4b5968";
        const gridColor = "rgba(0,0,0,.06)";

        // Top 5 Servidores (horizontal)
        new Chart(document.getElementById('topServidoresChart'), {
            type: 'bar',
            data: {
                labels: ['SERV-PACS', 'PACS-2', 'PACS-3', 'PACS-4', 'PACS-5'],
                datasets: [{ label: 'Alertas', data: [30, 18, 12, 9, 6], borderRadius: 10, backgroundColor: '#32b9cd' }]
            },
            options: {
                indexAxis: 'y',
                plugins: { legend: { display: true, labels: { boxWidth: 10, usePointStyle: true, pointStyle: 'circle' } } },
                scales: {
                    x: { grid: { color: gridColor }, border: { display: false }, ticks: { stepSize: 5 } },
                    y: { grid: { display: false }, border: { display: false } }
                }
            }
        });

        // Componentes (barras)
        new Chart(document.getElementById('componentesChart'), {
            type: 'bar',
            data: {
                labels: ['CPU', 'RAM', 'DISCO'],
                datasets: [{ data: [8, 12, 16], backgroundColor: ['#32b9cd', '#32b9cd', '#32b9cd'], borderRadius: 12 }]
            },
            options: {
                plugins: { legend: { display: false } },
                scales: {
                    x: { grid: { display: false }, border: { display: false } },
                    y: { grid: { color: gridColor }, border: { display: false }, beginAtZero: true, ticks: { stepSize: 5 } }
                }
            }
        });

        // Linha anual
        new Chart(document.getElementById('linhaAnoChart'), {
            type: 'line',
            data: {
                labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun', 'Jul', 'Ago', 'Set', 'Out', 'Nov', 'Dez'],
                datasets: [{
                    label: 'Alertas', data: [25, 12, 15, 10, 14, 32, 18, 9, 6, 3, 1, 2], borderColor: '#32b9cd',
                    pointBackgroundColor: '#32bccd', pointRadius: 3.5, fill: false, tension: .35
                }]
            },
            options: {
                plugins: { legend: { display: false, labels: { boxWidth: 5, usePointStyle: true, pointStyle: 'circle' } } },
                scales: {
                    x: { grid: { display: false }, border: { display: false } },
                    y: { grid: { color: gridColor }, border: { display: false }, beginAtZero: true }
                }
            }
        });

        const minis = [
            { id: 'mini1', valor: 90, cor: '#32b9cd' },
            { id: 'mini2', valor: 40, cor: '#32b9cd' },
            { id: 'mini3', valor: 20, cor: '#32b9cd' }
        ];

        minis.forEach(({ id, valor, cor }) => {
            const el = document.getElementById(id);
            if (!el) return;
            new Chart(el, {
                type: 'bar',
                data: {
                    labels: [''],
                    datasets: [{
                        label: 'Uso (%)',
                        data: [valor],
                        backgroundColor: cor,
                        borderRadius: 8,
                        barPercentage: 0.7,
                        categoryPercentage: 1.0
                    }]
                },
                options: {
                    indexAxis: 'y',
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false }, tooltip: { callbacks: { label: c => `${c.raw}%` } } },
                    scales: {
                        x: {
                            min: 0, max: 100,
                            ticks: { callback: v => v + '%' },
                            grid: { display: false }, border: { display: false }
                        },
                        y: { grid: { display: false }, border: { display: false } }
                    }
                }
            });
        });
    </script>

</body>