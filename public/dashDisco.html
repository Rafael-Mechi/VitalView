<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard</title>
  <link rel="stylesheet" href="css/dashDisco.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
  <script src="js/sessao.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

  <nav class="menu">
    <input type="checkbox" name="chk_hamburguer" id="chk_hamburguer" class="check_hamburguer">

    <section class="hamburguer">
      <span class="menu_lateral">
        <div class="icones_topo">
          <img class="img_hamb" src="assets/LogoVitalView.png">
          <img src="./assets/dashboard-icons/home.svg" data-role="Analista,Administrador,Técnico">
          <img src="./assets/dashboard-icons/activity.svg" data-role="Analista,Administrador">
          <img src="./assets/dashboard-icons/bar-chart.svg" data-role="Técnico,Administrador">
          <img src="./assets/dashboard-icons/layout.svg" data-role="Técnico,Administrador">
        </div>

        <div class="icones_baixo">
          <img src="./assets/dashboard-icons/gerenciar-usuarios.png" data-role="Administrador"
            style="width: 28px; height: 28px;">
          <img src="./assets/dashboard-icons/calendar.svg" data-role="Analista,Técnico,Administrador">
          <img src="./assets/dashboard-icons/users.svg" data-role="Administrador">
          <img src="./assets/dashboard-icons/hard-drive.svg" data-role="Técnico,Administrador">
          <img src="./assets/dashboard-icons/help-circle.svg" data-role="Analista,Técnico,Administrador">
          <img src="./assets/dashboard-icons/log-out.svg" data-role="Analista,Técnico,Administrador">
        </div>
      </span>
    </section>

    <ul>
      <div class="title_hamb">
        <img class="img_hamb" src="assets/LogoVitalView.png" alt="">
        <h2 class="hamb_nome">VitalView</h2>
      </div>
      <div class="menu_topo">
        <h3 class="title_menu">Dashboards</h3>
        <li style="display: flex; align-items: center;" data-role="Analista,Administrador,Técnico">
          <img src="./assets/dashboard-icons/home.svg" style="width: 20px; margin-right: 4px;"><a
            href="bemVindo.html">Home</a>
        </li>
        <li style="display: flex; align-items: center;" data-role="Analista,Administrador"><img
            src="./assets/dashboard-icons/activity.svg" style="width: 20px; margin-right: 4px;"><a
            href="dashboardAnalista.html">Dash Analista</a></li>
        <li style="display: flex; align-items: center;" data-role="Técnico,Administrador"><img
            src="./assets/dashboard-icons/bar-chart.svg" style="width: 20px; margin-right: 4px;"><a
            href="dashboardSuporteMacro.html">Dash Suporte Macro</a></li>
        <li style="display: flex; align-items: center;" data-role="Técnico,Administrador" class="pagina-ativa">
          <img src="./assets/dashboard-icons/layout.svg" style="width: 20px; margin-right: 4px;"><a
            href="dashboardSuporteMicro.html">Dash Suporte Micro</a>
        </li>
        <li style="display: flex; align-items: center;" data-role="Técnico,Administrador">
          <img src="./assets/dashboard-icons/wifi (1).svg" style="width: 20px; margin-right: 4px;"><a
            href="dashRede.html">Dashboard Rede</a>
        </li>
      </div>

      <div class="menu_baixo">
        <h3 class="title_menu">Outras Opções</h3>
        <li style="display: flex; align-items: center;" data-role="Administrador"><img
            src="./assets/dashboard-icons/gerenciar-usuarios.png" style="width: 20px; margin-right: 4px;"><a
            href="dashControleSistema.html">Gerenciar usuários</a></li>
        <li style="display: flex; align-items: center;" data-role="Analista,Técnico,Administrador"><img
            src="./assets/dashboard-icons/calendar.svg" style="width: 20px; margin-right: 4px;"><a
            href="historicoAlertas.html">Histórico de Alertas</a></li>
        <li style="display: flex; align-items: center;" data-role="Administrador"><img
            src="./assets/dashboard-icons/users.svg" style="width: 20px; margin-right: 4px;"><a
            href="cadastroFuncionarios.html">Cadastro Funcionário</a></li>
        <li style="display: flex; align-items: center;" data-role="Técnico,Administrador"><img
            src="./assets/dashboard-icons/hard-drive.svg" style="width: 20px; margin-right: 4px;"><a
            href="cadastroServidores.html">Cadastro Servidores</a></li>
        <li style="display: flex; align-items: center;" data-role="Analista,Técnico,Administrador"><img
            src="./assets/dashboard-icons/help-circle.svg" style="width: 20px; margin-right: 4px;"><a
            href="https://vitalviewsptech.atlassian.net/servicedesk/customer/portal/1" target="_blank">Central de
            Serviço</a></li>
        <li style="display: flex; align-items: center;" data-role="Analista,Técnico,Administrador"><img
            src="./assets/dashboard-icons/log-out.svg" style="width: 20px; margin-right: 4px;"><a
            onclick="limparSessao()">Sair</a></li>
      </div>
    </ul>
  </nav>


  <section class="container">
    <section class="nav-dash">
      <section class="secao_logo">
        <a href="bemVindo.html">
          <img src="assets/LogoVitalView.png" alt="Logo VitalView" class="logo" />
        </a>
      </section>
      <section class="secao_logo">
        <h1 class="titulo_header">VitalView</h1>
      </section>
      <button class="botao_arquivos">Gerenciar Arquivos</button>
    </section>

    <section class="container-de-sessoes">

      <!-- KPIS: -->

      <!-- <div class="centralizador">
            <div class="numero_resumo">94%</div>
            <div class="centralizador_superior">
              <div>Resumo do armazenamento</div>
              <div>Espaço</div>
              <div>Última atualização: agora</div>
            </div>
            <div class="centralizar_inferior">
              <div>Espaço usado</div>
              <div>
                186.75 GB
                <span class="variacao positiva">
                  <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" fill="green" viewBox="0 0 24 24"><path d="M12 4l6 6h-4v10h-4V10H6z" /></svg>+0.2%</span>
              </div>
              <div>Espaço livre</div>
              <div>59.25 GB</div>
            </div>
            <div class="div_graficoLinha">=============</div>
            <div>(últimas 24h)</div>
          </div> -->

      <div class="bloco_kpi_disco">

        <div class="kpi_grafico_atividade">
          <div class="centralizador_titulo">
            <div class="texto_esquerda">
                <p>Tempo de atividade</p>
                <h1>5%</h1>
            </div>
            <div class="texto_direita">
              <p>Última atualiazação</p>
              <p>20:55:09</p>
            </div>
          </div>
          <div class="grafico_atividade">
            <canvas id="graficoAtividade"></canvas>
          </div>
        </div>

      </div>

      <div class="container-divs_inferiores">

        <div class="div_taxa">
          <div class="centralizador">
            <div class="UD_texto_esquerda">
              <div class="p_esquerda">Uso de Disco</div>
              <div class="numero_uso_disco"><h1 style="color: red;">94.4%</h1></div>
              <div class="p_esquerda">210.5 GB usados de 500 GB</div>
            </div>
            <div class="UD_texto_direita">
              <p style="color: red;">▲ +0.4%</p>
            </div>
          </div>
          <canvas id="graficoUsoDeDisco"></canvas>
        </div>

        <div class="div_taxa">
          <div class="centralizador">
            <div class="UD_texto_esquerda">
              <div class="p_esquerda">Taxa de Transferência</div>
              <div class="numero_uso_disco"><h1>107.1 MB/s</h1></div>
              <div class="p_esquerda">Leitura / Gravação</div>
            </div>
            <div class="UD_texto_direita">
              <p style="color: red;">▼ -0.7 MB/s</p>
            </div>
          </div>
          <canvas id="graficoTaxaTransferencia"></canvas>
        </div>

        <div class="div_taxa">
          <div class="centralizador">
            <div class="UD_texto_esquerda">
              <div class="p_esquerda">Latência média (IO)</div>
              <div class="numero_uso_disco"><h1>20.2 ms</h1></div>
              <div class="p_esquerda">Tempo médio de resposta</div>
            </div>
            <div class="UD_texto_direita">
              <p style="color: green;">▼ +0.3 ms</p>
            </div>
          </div>
          <canvas id="graficoLatencia"></canvas>
        </div>


    </section>
  </section>

</body>

<script>
  // ---------------- GRAFICO PRINCIPAL DE ATIVIDADE ----------------
  const ctx = document.getElementById("graficoAtividade").getContext("2d");
  const valorAtividade = document.querySelector(".texto_esquerda h1");
  const horaAtualizacao = document.querySelector(".texto_direita p:last-child");

  const dadosMock = {
    labels: ["-5s", "-4s", "-3s", "-2s", "-1s", "now()"],
    datasets: [
      {
        label: "Atividade (%)",
        data: [10, 50, 70, 50, 33, 50],
        borderColor: "#00c49f",
        backgroundColor: "rgba(0,196,159,0.2)",
        fill: true,
        tension: 0.3,
        pointRadius: 0,
      },
    ],
  };

  const opcoes = {
    responsive: true,
    maintainAspectRatio: false,
    scales: {
      y: {
        beginAtZero: true,
        max: 100,
        grid: { color: "rgba(255,255,255,0.05)" },
        ticks: { color: "#aaa" },
      },
      x: {
        grid: { display: false },
        ticks: { color: "#aaa" },
      },
    },
    plugins: {
      legend: { display: false },
      tooltip: {
        backgroundColor: "#222",
        titleColor: "#fff",
        bodyColor: "#fff",
      },
    },
    animation: { duration: 600, easing: "easeOutQuart" },
  };

  const graficoAtividade = new Chart(ctx, {
    type: "line",
    data: dadosMock,
    options: opcoes,
  });

  setInterval(() => {
    const novoValor = Math.floor(Math.random() * 100);
    const dataset = graficoAtividade.data.datasets[0];
    dataset.data.shift();
    dataset.data.push(novoValor);
    graficoAtividade.update();

    valorAtividade.textContent = `${novoValor}%`;

    const agora = new Date();
    horaAtualizacao.textContent = agora.toLocaleTimeString("pt-BR", { hour12: false });
  }, 1500);


  // ---------------- GRAFICO DE USO DE DISCO ----------------
  const ctx1 = document.getElementById('graficoUsoDeDisco').getContext('2d');
  const valorUso = document.querySelectorAll('.numero_uso_disco h1')[0];
  const textoUso = document.querySelectorAll('.p_esquerda')[1];
  const variacaoUso = document.querySelectorAll('.UD_texto_direita p')[0];

  const graficoUso = new Chart(ctx1, {
    type: 'bar',
    data: {
      labels: ['Uso de Disco'],
      datasets: [{
        label: 'Usado',
        data: [94.4],
        backgroundColor: '#008c99',
        borderRadius: 10,
        barThickness: 20
      }]
    },
    options: {
      indexAxis: 'y',
      scales: {
        x: {
          min: 0,
          max: 100,
          ticks: { callback: value => value + '%' }
        },
        y: { display: false }
      },
      plugins: { legend: { display: false }, tooltip: { enabled: false } }
    }
  });

  setInterval(() => {
    const novoValor = (Math.random() * 100).toFixed(1);
    graficoUso.data.datasets[0].data = [novoValor];
    graficoUso.update();

    valorUso.textContent = `${novoValor}%`;
    textoUso.textContent = `${(novoValor * 5).toFixed(1)} GB usados de 500 GB`;

    const variacao = (Math.random() * 1 - 0.5).toFixed(1);
    variacaoUso.textContent = `${variacao >= 0 ? "▲" : "▼"} ${variacao}%`;
    variacaoUso.style.color = variacao >= 0 ? "red" : "green";
  }, 2000);


  // ---------------- TAXA DE TRANSFERÊNCIA ----------------
  const ctx2 = document.getElementById('graficoTaxaTransferencia').getContext('2d');
  const valorTaxa = document.querySelectorAll('.numero_uso_disco h1')[1];
  const variacaoTaxa = document.querySelectorAll('.UD_texto_direita p')[1];

  const dadosMock2 = Array.from({ length: 30 }, () => Math.random() * 100);
  const graficoTaxa = new Chart(ctx2, {
    type: 'bar',
    data: {
      labels: dadosMock2.map((_, i) => i + 1),
      datasets: [{
        label: 'Taxa',
        data: dadosMock2,
        backgroundColor: '#008c99',
        borderRadius: 4,
        borderSkipped: false,
        barThickness: 6
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        x: { display: false },
        y: { display: false, min: 0, max: 100 }
      },
      plugins: { legend: { display: false }, tooltip: { enabled: false } },
      animation: { duration: 500 }
    }
  });

  setInterval(() => {
    const novoValor = (Math.random() * 200).toFixed(1);
    graficoTaxa.data.datasets[0].data.shift();
    graficoTaxa.data.datasets[0].data.push(novoValor);
    graficoTaxa.update();

    const variacao = (Math.random() * 2 - 1).toFixed(1);
    valorTaxa.textContent = `${novoValor} MB/s`;
    variacaoTaxa.textContent = `${variacao >= 0 ? "▲" : "▼"} ${variacao} MB/s`;
    variacaoTaxa.style.color = variacao >= 0 ? "green" : "red";
  }, 1200);


  // ---------------- LATÊNCIA MÉDIA ----------------
  const ctxLatencia = document.getElementById('graficoLatencia').getContext('2d');
  const valorLatencia = document.querySelectorAll('.numero_uso_disco h1')[2];
  const variacaoLatencia = document.querySelectorAll('.UD_texto_direita p')[2];

  const graficoLatencia = new Chart(ctxLatencia, {
    type: 'bar',
    data: {
      labels: ['Latência média'],
      datasets: [{
        data: [22.7],
        backgroundColor: 'rgba(0, 255, 180, 0.8)',
        borderRadius: 8,
        barThickness: 10
      }]
    },
    options: {
      indexAxis: 'y',
      responsive: true,
      maintainAspectRatio: false,
      scales: {
        x: { min: 0, max: 100, display: false, grid: { display: false } },
        y: { display: false, grid: { display: false } }
      },
      plugins: { legend: { display: false }, tooltip: { enabled: false } },
      animation: { duration: 500 }
    }
  });

  setInterval(() => {
    const novoValor = (Math.random() * 60).toFixed(1);
    graficoLatencia.data.datasets[0].data = [novoValor];
    graficoLatencia.update();

    valorLatencia.textContent = `${novoValor} ms`;

    const variacao = (Math.random() * 2 - 1).toFixed(1);
    variacaoLatencia.textContent = `${variacao >= 0 ? "▲" : "▼"} ${variacao} ms`;
    variacaoLatencia.style.color = variacao >= 0 ? "red" : "green";
  }, 1500);
</script>


</html>

